# タスク状況 - Treasure AR App

## 完了済みタスク ✅

### 1. Flutter環境のインストール（Flutter SDK、Xcode）
- Homebrewを使用してFlutter SDKをインストール完了
- CocoaPodsもインストール済み
- Xcodeは現在インストール中だが、ドメインロジックの開発は可能

### 2. Flutterプロジェクトの作成（treasure-ar-app）
- プロジェクト作成完了
- DDD（Domain-Driven Design）のフォルダ構造を設定
  - presentation/
  - application/
  - domain/
  - infrastructure/

### 3. ARKit Flutter pluginの導入と設定
- pubspec.yamlにarkit_pluginを追加
- iOS Info.plistにカメラ権限を設定
- vector_mathパッケージも追加（3D位置計算用）

### 9. 宝箱ドメインモデルの実装（TDD）
- TDD（テスト駆動開発）アプローチで実装完了
- 実装内容：
  - `Position3D` 値オブジェクト：3D座標と距離計算機能
  - `TreasureBoxState` sealed class：型安全な状態管理
    - HiddenState（隠れている状態）
    - FoundState（見つかった状態）
    - OpenedState（開いた状態）
  - `TreasureBox` エンティティ：状態遷移ロジック
    - Hidden → Found → Opened の順序でのみ遷移可能
    - 不正な状態遷移は例外をスロー
- 全テスト合格、フォーマット・リント完了
- コミット済み：「feat: add treasure box domain model with state transitions」

## 進行中タスク 🏃

### 4. 基本的なAR平面検出機能の実装
- 次のステップ：ARセッション管理のドメインモデル設計
- Xcodeインストール待ちだが、ドメイン層の開発は継続可能

## 保留中タスク 📋

### 5. 宝箱の3Dオブジェクト配置機能の実装
- 宝箱リポジトリインターフェースの設計が必要
- ユースケースの実装が必要

### 6. モード切り替え（大人モード/子供モード）の実装
- ゲームモードのドメインモデル設計が必要

### 7. タップ検出と宝箱発見演出の実装
- インタラクションのユースケース設計が必要

### 8. 視覚・聴覚フィードバックの実装
- フィードバックシステムの設計が必要

## 開発方針

### TDD（テスト駆動開発）
- 全ての実装はテストファーストで進行
- ドメインモデル → ユースケース → インフラ → プレゼンテーションの順

### DDD（ドメイン駆動設計）
- 4層アーキテクチャを厳守
- ドメインロジックはフレームワーク非依存

### 型安全性
- sealed classを使用した状態管理
- 文字列ステータスの代わりに型で状態を表現

### コミット戦略
- 各機能単位で細かくコミット
- コミット前に必ずテスト・フォーマット・リントを実行
- Makefileを使用した自動化

## 次のアクション

Xcodeのインストールを待つ間、以下のドメイン層の開発を継続可能：

1. TreasureBoxRepositoryインターフェースの設計・実装
2. ARセッション管理のドメインモデル設計
3. 宝箱配置・検索のユースケース実装
4. ゲームモード（大人/子供）のドメインモデル設計

これらはすべてユニットテストで検証可能なため、iOS実機やシミュレータなしで開発を進められます。